hostname l3-sw-02
enable secret cisco_l3_secret02
username melcy privilege 15 secret cisco
banner motd Authorized Access Only!!!
service password-encryption
ip domain-name cisco.com
crypto key generate rsa usage-keys label ssh-key modulus 1024
ip routing
line vty 0 4
 password cisco123
 login local
 transport input ssh
vlan 10
 name CORE
vlan 20
 name MGMT
vlan 30
 name COMPUTE
vlan 99
 name NATIVE
vlan 100
 name R&D
vlan 200
 name EMPLOYEE
vlan 300
 name GUEST
vlan 999
 name BLACKHOLE
spanning-tree mode pvst
spanning-tree vlan 10,20,30,100,200,300 priority 28672
interface Loopback0
 description LOOPBACK - SSH
 ip address 172.16.255.3 255.255.255.255
 no shutdown
interface FastEthernet0/1
 description TRUNK TO access-sw-01 fa0/1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk native vlan 99
 no shutdown
interface FastEthernet0/2
 description TRUNK TO l3-sw-01 fa0/2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 no shutdown
interface FastEthernet0/3
 description TRUNK TO l3-sw-01 fa0/3
 switchport trunk encapsulation dot1q
 switchport mode trunk
 no shutdown
interface FastEthernet0/4
 description TRUNK TO access-sw-03 fa0/1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk native vlan 99
 no shutdown
interface FastEthernet0/5
 description TRUNK TO access-sw-04 fa0/2
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk native vlan 99
 no shutdown
interface range FastEthernet0/6-24
 description SPARE / RESERVED FOR FUTURE USE
 switchport mode access
 switchport access vlan 999
 shutdown
interface GigabitEthernet0/1
 description UPLINK TO core-r1 g0/1
 no switchport
 ip address 172.16.12.230 255.255.255.252
 no shutdown
interface GigabitEthernet0/2
 description TRUNK TO access-sw-02 g0/1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk native vlan 99
 no shutdown
interface VLAN1
 shutdown
interface VLAN10
 description VLAN10 COMPUTE
 ip address 172.16.12.2 255.255.255.224
 no shutdown
 ip helper-address 172.16.12.229
 vrrp 10 ip 172.16.12.30
 vrrp 10 priority 100
 vrrp 10 authentication text {{ vrrp_auth_text }}
interface VLAN20
 description VLAN20 MANAGEMENT
 ip address 172.16.12.34 255.255.255.224
 no shutdown
 ip helper-address 172.16.12.229
 vrrp 20 ip 172.16.12.62
 vrrp 20 priority 100
 vrrp 20 authentication text {{ vrrp_auth_text }}
interface VLAN30
 description VLAN30 COMPUTE
 ip address 172.16.12.66 255.255.255.224
 no shutdown
 ip helper-address 172.16.12.229
 vrrp 30 ip 172.16.12.94
 vrrp 30 priority 100
 vrrp 30 authentication text {{ vrrp_auth_text }}
interface VLAN100
 description VLAN100 R&D
 ip address 172.16.12.130 255.255.255.224
 no shutdown
 ip helper-address 172.16.12.226
 vrrp 100 ip 172.16.12.158
 vrrp 100 priority 100
 vrrp 100 authentication text {{ vrrp_auth_text }}
interface VLAN200
 description VLAN200 EMPLOYEE
 ip address 172.16.12.162 255.255.255.224
 no shutdown
 ip helper-address 172.16.12.226
 vrrp 200 ip 172.16.12.190
 vrrp 200 priority 100
 vrrp 200 authentication text {{ vrrp_auth_text }}
interface VLAN300
 description VLAN300 GUEST
 ip address 172.16.12.194 255.255.255.224
 no shutdown
 ip helper-address 172.16.12.226
 vrrp 300 ip 172.16.12.222
 vrrp 300 priority 100
 vrrp 300 authentication text {{ vrrp_auth_text }}
router ospf 1
 router-id 3.3.3.3
 passive-interface default
 no passive-interface GigabitEthernet0/1
 network 172.16.12.0 0.0.0.31 area 0
 network 172.16.12.32 0.0.0.31 area 0
 network 172.16.12.64 0.0.0.31 area 0
 network 172.16.12.96 0.0.0.31 area 0
 network 172.16.12.128 0.0.0.31 area 0
 network 172.16.12.160 0.0.0.31 area 0
 network 172.16.12.192 0.0.0.31 area 0
 network 172.16.12.224 0.0.0.31 area 0
 network 172.16.12.230 0.0.0.3 area 0
ip access-list extended MGMT_VTY_ACL
 remark RESTRICT SSH MANAGEMENT ACCESS
 remark ONLY ALLOW FROM MANAGEMENT VLAN 20
 permit tcp 172.16.12.32 0.0.0.31 any eq 22
 remark ALLOW OTHER TRAFFIC
 permit ip any  any
ip default-gateway 172.16.12.98
end
